import{f as e,o as t,i as r,a as s,b as a,c as n,R as i,S as o,d as c,F as l,A as u,O as f,t as g,B as p,e as m,g as d,I as h,h as y,V as b,j as w,k as v,l as j,m as E,D as T,n as P,w as x}from"./with-resolvers-BbzrtcFW.js";import{t as M}from"./global-DKJApQIy.js";import{n as O}from"./shared-array-buffer-cwdMr2mc.js";let R=0;const k=R++,L=R++,S=R++,B=R++,A=R++,F=R++,W=R++,$=R++,z=R++,D=R++,I=R++,N=R++,U=R++,_=R++,q=R++;R++;const K=R++,V=R++,Y=(t,r)=>[r?t:e(new Uint8Array(t)),t.resizable?t.maxByteLength:0],C=/\[('|")?(.+?)\1\]/g,G=(e,t)=>e?.[t];var H=(e,t)=>t.replace(C,".$2").split(".").reduce(G,e),J=(e,...t)=>t.map(Q,e);function Q(e){return"string"==typeof e?H(this,e):this[e]}const X=globalThis.Node||class{},{apply:Z,construct:ee,defineProperty:te,deleteProperty:re,get:se,getOwnPropertyDescriptor:ae,getPrototypeOf:ne,has:ie,isExtensible:oe,ownKeys:ce,set:le,setPrototypeOf:ue}=Reflect;var fe=({reflect:e=r,transform:x=r,remote:O=r,module:R=e=>import(e),buffer:C=!1,timeout:G=-1}=t)=>{const Q=(t,r=new Map)=>{if(!n(t))return t;const[s,a]=t;switch(s){case f:{if(null===a)return globalThis;let e=r.get(t);if(!e){e=a,r.set(t,a);for(const e in a)a[e]=Q(a[e],r)}return e}case u:return r.get(t)||(r.set(t,a),ge(a,r));case l:{let t=je.get(a),r=t?.deref();return r||(t&&Te.unregister(t),r=function(...t){O.apply(this,t);for(let e=0,r=t.length;e<r;e++)t[e]=fe(t[e]);return e(F,a,fe(this),t).then(Q)},t=new WeakRef(r),je.set(a,t),Te.register(r,a,t)),r}case o:return c(a);default:return s&i?ye(a):a}},fe=e=>{switch(typeof e){case"object":{if(null===e)break;if(e===globalThis)return Ee;const t=x(e);return xe&&Pe.has(t)||t instanceof h?g(T,t):y(t)?g(b,((e,t)=>{const{BYTES_PER_ELEMENT:r,byteOffset:s,buffer:a,length:n}=e;return[M(e),Y(a,t),s,n!==(a.byteLength-s)/r?n:0]})(t,C)):t instanceof ArrayBuffer?g(w,Y(t,C)):g(n(t)?v:j,he(t))}case"function":return g(d,he(x(e)));case"symbol":return g(o,m(e));case"bigint":return g(p,e.toString())}return e},ge=E(Q),pe=E(a),me=E(P),{clear:de,id:he,ref:ye,unref:be}=((e=0,t=new Map,r=new Map)=>({clear:()=>{t.clear(),r.clear()},id:s=>{let a=r.get(s);if(void 0===a){for(;t.has(a=e++););t.set(a,s),r.set(s,a)}return a},ref:e=>t.get(e),unref:e=>(r.delete(t.get(e)),t.delete(e))}))(),we=/^(?:[0-9]+|length)$/,ve=-1<G,je=new Map,Ee=g(f,null),Te=new FinalizationRegistry(t=>{je.delete(t),e(k,t)});let Pe,xe=!1;return{assign:s,gather:J,query:H,direct:e=>(xe||(xe=!0,Pe=new WeakSet),Pe.add(e),e),evaluate:(e,...t)=>Z(e,null,t),reflect(e,t,...r){const i=null===t,o=i?globalThis:ye(t);switch(e){case D:{const e=a(r[0]),t=i&&"import"===e,s=t?R:se(o,e),c=fe(s);if(!ve)return c;let l,u=t,f=o;if(!t&&!(f instanceof X||n(f)&&"string"==typeof e&&we.test(e)))if(e in o){for(;!(l=ae(f,e))&&(f=ne(f),f););u=!!l&&"value"in l}else u=!0;return[u,c]}case F:{const e=new Map;return fe(Z(o,Q(r[0],e),ge(r[1],e)))}case K:return le(o,a(r[0]),Q(r[1]));case U:return ie(o,a(r[0]));case q:return me(ce(o),je);case W:return fe(ee(o,ge(r[0])));case I:{const e=ae(o,a(r[0]));if(e)for(const t in e)e[t]=fe(e[t]);return e}case $:return te(o,a(r[0]),Q(r[1]));case z:return re(o,a(r[0]));case N:return fe(ne(o));case V:return ue(o,Q(r[0]));case L:return void s(o,Q(r[0]));case S:{const e=Q(r[0]),t=Function(`return(${e}).apply(null,arguments)`);return fe(Z(t,null,ge(r[1])))}case B:for(let e,t=0,s=(r=pe(r[0],je)).length;t<s;t++)e=r[t],r[t]=fe("string"==typeof e?H(o,e):o[e]);return r;case A:return fe(H(o,r[0]));case k:return be(t);case _:return oe(o)}},terminate(){for(const e of je.values())Te.unregister(e);je.clear(),de()}}};let ge;if("importScripts"in globalThis){let e;const{promise:t,resolve:r}=x(),s=new URL(location).searchParams.get("reflected");e="message"===s?import("./message-BDoj0Sat.js"):"broadcast"===s?import("./broadcast-BqHn8hZt.js"):"xhr"===s?import("./xhr-DncbZcB-.js"):import("./async-GRzyB2di.js"),ge=async r=>{const{data:s,ports:a}=await t,{default:n}=await e,i=new Event("message");return i.data=s,i.ports=a,dispatchEvent(i),n(r)},addEventListener("message",r,{once:!0})}else ge=O?"InstallTrigger"in globalThis?(await import("./broadcast-B-ZTCBNa.js")).default:(await import("./message-BuTiKs-s.js")).default:navigator.serviceWorker?(await import("./xhr-CAzOMf0H.js")).default:(await import("./async-D7grUasQ.js").then(function(e){return e.a})).default;var pe=ge;const{assign:me}=Object;var de=async(e,t)=>{const r=fe({timeout:0,buffer:!0,...t,reflect:(...e)=>s.send(e)}),s=await pe(e,{...t,onsync:e=>r.reflect(...e)}),{terminate:a}=s;return me(s,{ffi:r,terminate(){r.terminate(),a.call(s)}})};export{de as default};
