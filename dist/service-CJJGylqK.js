import{w as e}from"./with-resolvers-CHEvl4oe.js";const{parse:s,stringify:t}=JSON,{promise:n,resolve:r}=e();addEventListener("message",({data:[e,s,t]})=>r([e,s,t]),{once:!0});const a="service",o=(e,n,r)=>{const a=new BroadcastChannel(e),o=(()=>{const e=new Int32Array(1);return()=>e[0]++})(),{serviceWorker:p}=r;return(c,...i)=>{const d=o();a.postMessage([d,c],...i);const u=new XMLHttpRequest;return u.open("POST",p,!1),u.setRequestHeader("Content-Type","application/json"),u.send(t([d,e])),n.set(s(u.responseText),0),r.ondata(n.subarray(2,2+n[1]),...i)}};var p=e=>n.then(([s,t,n])=>(postMessage(1),o(n,new Int32Array(s),{...t,...e})));export{a as channel,p as default};
